hist(BLUP19$Rust,
xlim = c(0,40),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP20$Rust,
xlim = c(0,50),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUPcc$DS_n,
xlim = c(0,50),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "",
)
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,90),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,100),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,100),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP19$Rust,
xlim = c(0,40),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
ylim = c(0,140),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
ylim = c(0,150),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
ylim = c(0,140),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP19$Rust,
xlim = c(0,40),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
ylim = c(0,140),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
## ENViRONMENT:
{
# What is the effect of the treatment on the value ?
model=lm( Rall_field$Rust ~ Rall_field$ENV )
ANOVA=aov(model)
# Tukey test to study each pair of treatment :
TUKEY <- TukeyHSD(x=ANOVA, 'Rall_field$ENV', conf.level=0.95)
# Tuckey test representation :
plot(TUKEY , las=1 , col="brown")
# I need to group the treatments that are not different each other together.
generate_label_df <- function(TUKEY, variable){
# Extract labels and factor levels from Tukey post-hoc
Tukey.levels <- TUKEY[[variable]][,4]
Tukey.labels <- data.frame(multcompLetters(Tukey.levels)['Letters'])
#I need to put the labels in the same order as in the boxplot :
Tukey.labels$treatment=rownames(Tukey.labels)
Tukey.labels=Tukey.labels[order(Tukey.labels$treatment) , ]
return(Tukey.labels)
}
# Apply the function on my dataset
LABELS <- generate_label_df(TUKEY, "Rall_field$ENV")
# A panel of colors to draw each group with the same color :
my_colors <- c(
rgb(143,199,74,maxColorValue = 255),
rgb(242,104,34,maxColorValue = 255),
rgb(111,145,202,maxColorValue = 255)
)
# Draw the basic boxplot
a <- boxplot(Rall_field$Rust ~ Rall_field$ENV , ylim=c(min(Rall_field$Rust) , 1.1*max(Rall_field$Rust)) , col=my_colors[as.numeric(LABELS[,1])] ,
ylab="Disease Severity (%)",
xlab = "Environment",
main="")
# I want to write the letter over each box. Over is how high I want to write it.
over <- 0.1*max( a$stats[nrow(a$stats),] )
#Add the labels
text( c(1:nlevels(Rall_field$ENV)) , a$stats[nrow(a$stats),]+over , LABELS[,1]  , col=my_colors[as.numeric(LABELS[,1])] )
}
# Draw the basic boxplot
a <- boxplot(Rall_field$Rust ~ Rall_field$ENV , ylim=c(min(Rall_field$Rust) , 1.1*max(Rall_field$Rust)) , col=my_colors[as.numeric(LABELS[,1])] ,
ylab="Disease Severity (%)",
xlab = "Environment",
main="Distribution of 320 accessions by environment")
# Draw the basic boxplot
a <- boxplot(Rall_field$Rust ~ Rall_field$ENV , ylim=c(min(Rall_field$Rust) , 1.1*max(Rall_field$Rust)) , col=my_colors[as.numeric(LABELS[,1])] ,
ylab="Disease Severity (%)",
xlab = "Environment",
main="Distribution by environment")
# I want to write the letter over each box. Over is how high I want to write it.
over <- 0.1*max( a$stats[nrow(a$stats),] )
#Add the labels
text( c(1:nlevels(Rall_field$ENV)) , a$stats[nrow(a$stats),]+over , LABELS[,1]  , col=my_colors[as.numeric(LABELS[,1])] )
# Draw the basic boxplot
a <- boxplot(Rall_field$Rust ~ Rall_field$ENV , ylim=c(min(Rall_field$Rust) , 1.1*max(Rall_field$Rust)) , col=my_colors[as.numeric(LABELS[,1])] ,
ylab="Disease Severity (%)",
xlab = "Environment",
main="Distribution by environment",
las = 1)
# I want to write the letter over each box. Over is how high I want to write it.
over <- 0.1*max( a$stats[nrow(a$stats),] )
#Add the labels
text( c(1:nlevels(Rall_field$ENV)) , a$stats[nrow(a$stats),]+over , LABELS[,1]  , col=my_colors[as.numeric(LABELS[,1])] )
hist(BLUP18$Rust,
xlim = c(5,25),
ylim = c(0,140),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUP18$Rust,
xlim = c(5,25),
ylim = c(0,140),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "a) 2018")
hist(BLUP19$Rust,
xlim = c(0,40),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "b) 2019")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 9,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 8,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 5,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,100),
border = "black",
col = "white",
breaks = 5,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 5,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 6,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 5.5,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 4,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,50),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 7,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,45),
ylim = c(0,120),
border = "black",
col = "white",
breaks = 7,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUP20$Rust,
xlim = c(0,45),
ylim = c(0,80),
border = "black",
col = "white",
breaks = 7,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "c) 2020")
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,100),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,90),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,100),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "")
hist(BLUPcc$DS_n,
xlim = c(0,50),
ylim = c(0,100),
border = "black",
col = "white",
breaks = 10,
las = 1,
ylab = "Nº pea accessions",
xlab = "DS range",
main = "d) DS in Controlled Condition")
View(BLUPcc)
knitr::opts_chunk$set(echo = TRUE)
# revisa si es necesario instalar los paquetes
list.of.packages <- c("tidyverse",
"ggpubr",
"ggstatsplot",
"openintro",
"rstatix",
"DescTools",
"WRS2",
"metan",
"ggstastplot",
"openxlsx",
"readxl")
new.packages <- list.of.packages[!(list.of.packages %in%
installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(tidyverse) # manipulación y visualización de datos
library(ggpubr) # gráficos sencillos
library(ggstatsplot) # gráficos listos para publicar
library(openintro) # datos de ejemplo
library(rstatix) # pruebas P/NP y estadísticos con tuberías.
library(DescTools) # prueba robusta de Yuen
library(WRS2) # tamaño de efecto robustos
library(metan)
library(ggstatsplot)
library(openxlsx)
library(readxl)
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
BLUPs_anova %>%
group_by(ENV, Material) %>%
get_summary_stats(BLUP, type = "mean_sd")
ggplot(data = BLUPs_anova, aes(x = Material, y = BLUP)) +
geom_boxplot(aes(fill = ENV), width = 0.8) + theme_bw()
ggqqplot(BLUPs_anova, "BLUP", ggtheme = theme_bw()) +
facet_grid(Material ~ ENV)
BLUPs_anova %>% levene_test(BLUP ~ Material*ENV)
BLUPs_anova %>%
group_by(ENV, Material) %>%
identify_outliers(BLUP)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Species * ENV)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Material, p.adjust.method = "holm")%>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
grouped_ggbetweenstats(data = BLUPs_anova, x = Material, y = BLUP, grouping.var = ENV, type = "np",
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
grouped_ggbetweenstats(data = BLUPs_anova, x = Species, y = BLUP, grouping.var = ENV, type = "np",
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
ggbetweenstats(x = Species, y = BLUP, data = BLUPs_anova,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(ENV ~ BLUP, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Species)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
anova_test(BLUP ~ Species)
BLUPs_anova %>%
filter_(ENV == "R18") %>%
anova_test(BLUP ~ Species)
BLUPs_anova %>%
filter_("ENV" == "R18") %>%
anova_test(BLUP ~ Species)
BLUPs_anova %>%
filter_("ENV" == R18) %>%
anova_test(BLUP ~ Species)
BLUPs_anova %>%
filter_("ENV" == "R18") %>%
anova_test(BLUP ~ Species)
BLUPs_anova %>%
filter_("ENV" == "R18") %>%
anova_test(BLUP ~ Species*ENV)
