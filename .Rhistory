R19_nc$REP <- as.factor(R19_nc$REP)
R19_nc$BLOCK <- as.factor(R19_nc$BLOCK)
R19_nc$ROW <- as.factor(R19_nc$ROW)
R19_nc$Material <- as.factor(R19_nc$Material)
R19_nc$Species <- as.factor(R19_nc$Species)
R19_nc$Structure <- as.factor(R19_nc$Structure)
R19_nc$GEN <- as.factor(R19_nc$GEN)
#season 2020
R20_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R20_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Asco
"numeric", #Oidio
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R20_nc$ENV <- as.factor(R20_nc$ENV)
R20_nc$REP <- as.factor(R20_nc$REP)
R20_nc$BLOCK <- as.factor(R20_nc$BLOCK)
R20_nc$ROW <- as.factor(R20_nc$ROW)
R20_nc$Material <- as.factor(R20_nc$Material)
R20_nc$Species <- as.factor(R20_nc$Species)
R20_nc$Structure <- as.factor(R20_nc$Structure)
R20_nc$GEN <- as.factor(R20_nc$GEN)
#Three field Seasons
Rall_field <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #Biom_pl_g
"numeric", #yield_pl_g
"numeric", #Rust
"numeric", #Asco
"numeric" #Oidio
))
Rall_field$ENV <- as.factor(Rall_field$ENV)
Rall_field$REP <- as.factor(Rall_field$REP)
Rall_field$BLOCK <- as.factor(Rall_field$BLOCK)
Rall_field$ROW <- as.factor(Rall_field$ROW)
Rall_field$Material <- as.factor(Rall_field$Material)
Rall_field$Species <- as.factor(Rall_field$Species)
Rall_field$Structure <- as.factor(Rall_field$Structure)
Rall_field$GEN <- as.factor(Rall_field$GEN)
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila (0 = NO aphila; 1 = SI aphila)
"numeric", #L_border (0 = Liso; 0,5 = Semi; 1 = dentado)
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc$REP <- as.factor(RCC_nc$REP)
RCC_nc$BLOCK <- as.factor(RCC_nc$BLOCK)
RCC_nc$GEN <- as.factor(RCC_nc$GEN)
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila (0 = NO aphila; 1 = SI aphila)
"numeric", #L_border (0 = Liso; 0,5 = Semi; 1 = dentado)
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc$REP <- as.factor(RCC_nc$REP)
RCC_nc$BLOCK <- as.factor(RCC_nc$BLOCK)
RCC_nc$GEN <- as.factor(RCC_nc$GEN)
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila (0 = NO aphila; 1 = SI aphila)
"numeric", #L_border (0 = Liso; 0,5 = Semi; 1 = dentado)
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc$REP <- as.factor(RCC_nc$REP)
RCC_nc$BLOCK <- as.factor(RCC_nc$BLOCK)
RCC_nc$GEN <- as.factor(RCC_nc$GEN)
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
#functions#
library("metan")
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
gen_alphaR19 <-
gamem(R19_nc,
GEN,
REP,
resp = c("GERM", "GDD_FF", "GDD_F", "GDD_FP", "GDD_P","GDD_M", "Rust", "Biom_plant_g", "yield_plant_g"),
BLOCK)
gen_alphaR20 <-
gamem(R20_nc,
GEN,
REP,
resp = c("GERM", "GDD_DTFF", "GDD_DTF", "GDD_DTFP", "GDD_DTP", "GDD_M", "Rust", "Asco", "Oidio", "Biom_plant_g", "yield_plant_g"),
BLOCK)
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n", "PL50_n", "DS_n", "IF_n", "IT_n"),
BLOCK)
FAI <- fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min", "min"),
UI = c("max, min, max, max", "max"),
SI = 15,
mineval = 1,
verbose = TRUE
)
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n", "DS_n", "IF_n", "IT_n"),
BLOCK)
FAI <- fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, min, min", "min"),
UI = c("max, max, max", "max"),
SI = 15,
mineval = 1,
verbose = TRUE
)
plot(FAI)
mixed_mod_Rall_field <-
gamem_met(Rall_field,
ENV,
GEN,
REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
block = BLOCK
)
data <- waasb_model$Rust$PCA
print(data)
#The WAASB object
waasb_model <-
waasb(Rall_field,
env = ENV,
gen = GEN,
rep = REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
random = "gen", #Default
verbose = TRUE) #Default
data <- waasb_model$Rust$PCA
print(data)
data1 <- waasb_model$Rust$MeansGxE
print(data1)
WAASB_rust <- waasb_model$Rust$BLUPgen
e <- plot_waasby(waasb_model)
f <- plot_waasby(waasb_model, col.shape = c("gray20", "gray80"))
arrange_ggplot(i, j, tag_levels = list(c("e", "f")))
arrange_ggplot(e, f, tag_levels = list(c("e", "f")))
i <- plot_scores(waasb_model, type = 4)
j <- plot_scores(waasb_model,
type = 4,
size.tex.gen = 1.5,
color = FALSE,
col.alpha.gen = 0,
col.alpha.env = 0,
plot_theme = theme_metan(color.background = "white"))
arrange_ggplot(i, j, tag_levels = list(c("i", "j")))
get_model_data(gen_alphaR18)
get_model_data(gen_alphaR19)
get_model_data(gen_alphaR20)
details_Rall <- get_model_data(mixed_mod_Rall_field, "genpar")
get_model_data(mixed_mod_Rall_field, "genpar")
mixed_mod_Rall_field <-
gamem_met(Rall_field,
ENV,
GEN,
REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g")
)
get_model_data(mixed_mod_Rall_field, "genpar")
mixed_mod_Rall_field <-
gamem_met(Rall_field,
ENV,
GEN,
REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
block = BLOCK
)
get_model_data(gen_alphaRCC)
corr_plot(gen_alphaRCC)
corr_plot(RCC_nc, c("AUDPC_n", "PL50_n", "IF_n", "DS_n", "IT_n"))
get_model_data(gen_alphaRCC, what = "blupg")
BLUPcc <- get_model_data(gen_alphaRCC, what = "blupg")
corr_plot(BLUPcc, c("AUDPC_n", "PL50_n", "IF_n", "DS_n", "IT_n"))
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n","PL50_n", "DS_n", "IF_n", "IT_n"),
BLOCK)
BLUPcc <- get_model_data(gen_alphaRCC, what = "blupg")
corr_plot(BLUPcc, c("AUDPC_n", "PL50_n", "IF_n", "DS_n", "IT_n"))
BLUP18 <- get_model_data(gen_alphaR18, what = "blupg")
BLUP18
BLUP19 <- get_model_data(gen_alphaR19, what = "blupg")
BLUP20 <- get_model_data(gen_alphaR20, what = "blupg")
BLUP18
library(tidyverse)
BLUP18_19 <- left_join(BLUP18,BLUP19, by = "GEN")
corr_plot(BLUP18_19)
BLUP_ALL <- left_join(BLUP18,BLUP19,BLUP20,BLUPcc, by = "GEN")
BLUP_ALL <- left_join(BLUP18,BLUP19,BLUP20, by = "GEN")
BLUP18_19 <- left_join(BLUP18,BLUP19, by = "GEN")
BLUP18_19
BLUP18_19_20 <- left_join(BLUP18_19,BLUP20, by = "GEN")
summary(BLUP18_19_20)
BLUPALL <- left_join(BLUP18_19_20,BLUPcc, by = "GEN")
summary(BLUPALL)
corr_plot(BLUPALL, c("Rust", "Rust.x", "Rust.y","AUDPC_n", "PL50_n", "IF_n", "DS_n", "IT_n" ))
##LOAD DATA##
library(readxl)
#season 2018
{
R18_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R18_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"numeric", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #DtP
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #Asco
"numeric", #Rust
"numeric" #Oidio
))
R18_nc$ENV <- as.factor(R18_nc$ENV)
R18_nc$REP <- as.factor(R18_nc$REP)
R18_nc$BLOCK <- as.factor(R18_nc$BLOCK)
R18_nc$ROW <- as.factor(R18_nc$ROW)
R18_nc$Material <- as.factor(R18_nc$Material)
R18_nc$Species <- as.factor(R18_nc$Species)
R18_nc$Structure <- as.factor(R18_nc$Structure)
R18_nc$GEN <- as.factor(R18_nc$GEN)
}
#season 2019
{
R19_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R19_nc$ENV <- as.factor(R19_nc$ENV)
R19_nc$REP <- as.factor(R19_nc$REP)
R19_nc$BLOCK <- as.factor(R19_nc$BLOCK)
R19_nc$ROW <- as.factor(R19_nc$ROW)
R19_nc$Material <- as.factor(R19_nc$Material)
R19_nc$Species <- as.factor(R19_nc$Species)
R19_nc$Structure <- as.factor(R19_nc$Structure)
R19_nc$GEN <- as.factor(R19_nc$GEN)
}
#season 2020
{
R20_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R20_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Asco
"numeric", #Oidio
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R20_nc$ENV <- as.factor(R20_nc$ENV)
R20_nc$REP <- as.factor(R20_nc$REP)
R20_nc$BLOCK <- as.factor(R20_nc$BLOCK)
R20_nc$ROW <- as.factor(R20_nc$ROW)
R20_nc$Material <- as.factor(R20_nc$Material)
R20_nc$Species <- as.factor(R20_nc$Species)
R20_nc$Structure <- as.factor(R20_nc$Structure)
R20_nc$GEN <- as.factor(R20_nc$GEN)
}
#Growth Chamber. Controlled conditions:
{
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila (0 = NO aphila; 1 = SI aphila)
"numeric", #L_border (0 = Liso; 0,5 = Semi; 1 = dentado)
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc$REP <- as.factor(RCC_nc$REP)
RCC_nc$BLOCK <- as.factor(RCC_nc$BLOCK)
RCC_nc$GEN <- as.factor(RCC_nc$GEN)
}
#Three field Seasons together. Data from multi-environment trials
{
Rall_field <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #Biom_pl_g
"numeric", #yield_pl_g
"numeric", #Rust
"numeric", #Asco
"numeric" #Oidio
))
Rall_field$ENV <- as.factor(Rall_field$ENV)
Rall_field$REP <- as.factor(Rall_field$REP)
Rall_field$BLOCK <- as.factor(Rall_field$BLOCK)
Rall_field$ROW <- as.factor(Rall_field$ROW)
Rall_field$Material <- as.factor(Rall_field$Material)
Rall_field$Species <- as.factor(Rall_field$Species)
Rall_field$Structure <- as.factor(Rall_field$Structure)
Rall_field$GEN <- as.factor(Rall_field$GEN)
}
#Season 2018:
{
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
BLUP18 <- get_model_data(gen_alphaR18, what = "blupg")
get_model_data(gen_alphaR18)
get_model_data(gen_alphaR18, "lrt")
get_model_data(gen_alphaR18, "details")
}
#Analysis of single environment/experiment using mixed-models
library("metan")
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
BLUP18 <- get_model_data(gen_alphaR18, what = "blupg")
get_model_data(gen_alphaR18)
inspect(R18_nc)
desc_stat(R18_nc, stats = "main")
desc_stat(R18_nc, stats = "robust")
desc_stat(R18_nc, stats = "all")
stat18 <- desc_stat(R18_nc, stats = "all")
View(stat18)
stat19 <- desc_stat(R19_nc, stats = "all")
View(stat19)
View(stat18)
stat20 <- desc_stat(R20_nc, stats = "all")
View(stat20)
View(R20_nc)
View(R19_nc)
statCC <- desc_stat(RCC_nc, stats = "all")
View(statCC)
statFIELD <- desc_stat(Rall_field, stats = "all")
View(statFIELD)
get_model_data(gen_alphaR18)
get_model_data(gen_alphaR18, "details")
get_model_data(gen_alphaR18, "lrt")
get_model_data(gen_alphaR19)
gen_alphaR19 <-
gamem(R19_nc,
GEN,
REP,
resp = c("GERM", "GDD_FF", "GDD_F", "GDD_FP", "GDD_P","GDD_M", "Rust", "Biom_plant_g", "yield_plant_g"),
BLOCK)
get_model_data(gen_alphaR19)
get_model_data(gen_alphaR19, "lrt")
get_model_data(gen_alphaR20)
gen_alphaR20 <-
gamem(R20_nc,
GEN,
REP,
resp = c("GERM", "GDD_DTFF", "GDD_DTF", "GDD_DTFP", "GDD_DTP", "GDD_M", "Rust", "Asco", "Oidio", "Biom_plant_g", "yield_plant_g"),
BLOCK)
get_model_data(gen_alphaR20)
get_model_data(gen_alphaR20, "lrt")
asd <- get_model_data(gen_alphaR20, "lrt")
View(asd)
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n","PL50_n", "DS_n", "IF_n", "IT_n"),
BLOCK)
get_model_data(gen_alphaRCC)
get_model_data(gen_alphaRCC, "lrt")
get_model_data(mixed_mod_Rall_field, "genpar")
#BLUPs
mixed_mod_Rall_field <-
gamem_met(Rall_field,
ENV,
GEN,
REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
block = BLOCK
)
get_model_data(mixed_mod_Rall_field, "genpar")
get_model_data(mixed_mod_Rall_field, "lrt")
