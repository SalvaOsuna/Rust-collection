c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R19_nc$ENV <- as.factor(R19_nc$ENV)
R19_nc$REP <- as.factor(R19_nc$REP)
R19_nc$BLOCK <- as.factor(R19_nc$BLOCK)
R19_nc$ROW <- as.factor(R19_nc$ROW)
R19_nc$Material <- as.factor(R19_nc$Material)
R19_nc$Species <- as.factor(R19_nc$Species)
R19_nc$Structure <- as.factor(R19_nc$Structure)
R19_nc$GEN <- as.factor(R19_nc$GEN)
}
#season 2020
{
R20_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R20_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Asco
"numeric", #Oidio
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R20_nc$ENV <- as.factor(R20_nc$ENV)
R20_nc$REP <- as.factor(R20_nc$REP)
R20_nc$BLOCK <- as.factor(R20_nc$BLOCK)
R20_nc$ROW <- as.factor(R20_nc$ROW)
R20_nc$Material <- as.factor(R20_nc$Material)
R20_nc$Species <- as.factor(R20_nc$Species)
R20_nc$Structure <- as.factor(R20_nc$Structure)
R20_nc$GEN <- as.factor(R20_nc$GEN)
}
#Growth Chamber. Controlled conditions:
{
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila (0 = NO aphila; 1 = SI aphila)
"numeric", #L_border (0 = Liso; 0,5 = Semi; 1 = dentado)
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc$REP <- as.factor(RCC_nc$REP)
RCC_nc$BLOCK <- as.factor(RCC_nc$BLOCK)
RCC_nc$GEN <- as.factor(RCC_nc$GEN)
}
#Three field Seasons together. Data from multi-environment trials
{
Rall_field <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #Biom_pl_g
"numeric", #yield_pl_g
"numeric", #Rust
"numeric", #Asco
"numeric" #Oidio
))
Rall_field$ENV <- as.factor(Rall_field$ENV)
Rall_field$REP <- as.factor(Rall_field$REP)
Rall_field$BLOCK <- as.factor(Rall_field$BLOCK)
Rall_field$ROW <- as.factor(Rall_field$ROW)
Rall_field$Material <- as.factor(Rall_field$Material)
Rall_field$Species <- as.factor(Rall_field$Species)
Rall_field$Structure <- as.factor(Rall_field$Structure)
Rall_field$GEN <- as.factor(Rall_field$GEN)
}
library(metan)
library(ggstatsplot)
knitr::opts_chunk$set(echo = TRUE)
# revisa si es necesario instalar los paquetes
list.of.packages <- c("tidyverse",
"ggpubr",
"ggstatsplot",
"openintro",
"rstatix",
"DescTools",
"WRS2",
"metan",
"ggstastplot"
"openxlsx"
# revisa si es necesario instalar los paquetes
list.of.packages <- c("tidyverse",
"ggpubr",
"ggstatsplot",
"openintro",
"rstatix",
"DescTools",
"WRS2",
"metan",
"ggstastplot",
"openxlsx",
"readxl")
new.packages <- list.of.packages[!(list.of.packages %in%
installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(tidyverse) # manipulación y visualización de datos
library(ggpubr) # gráficos sencillos
library(ggstatsplot) # gráficos listos para publicar
library(openintro) # datos de ejemplo
library(rstatix) # pruebas P/NP y estadísticos con tuberías.
library(DescTools) # prueba robusta de Yuen
library(WRS2) # tamaño de efecto robustos
library(metan)
library(ggstatsplot)
library(openxlsx)
library(readxl)
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
BLUP18 <- get_model_data(gen_alphaR18, what = "blupg")
gen_alphaR19 <-
gamem(R19_nc,
GEN,
REP,
resp = c("GERM", "GDD_FF", "GDD_F", "GDD_FP", "GDD_P","GDD_M", "Rust", "Biom_plant_g", "yield_plant_g"),
BLOCK)
BLUP19 <- get_model_data(gen_alphaR19, what = "blupg")
gen_alphaR20 <-
gamem(R20_nc,
GEN,
REP,
resp = c("GERM", "GDD_DTFF", "GDD_DTF", "GDD_DTFP", "GDD_DTP", "GDD_M", "Rust", "Asco", "Oidio", "Biom_plant_g", "yield_plant_g"),
BLOCK)
BLUP20 <- get_model_data(gen_alphaR20, what = "blupg")
gen_alphaRCC_noLP <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n", "DS_n", "IF_n", "IT_n"),
BLOCK)
BLUPcc_noLP <- get_model_data(gen_alphaRCC_noLP, what = "blupg")
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n", "PL50_n","DS_n", "IF_n", "IT_n"),
BLOCK)
BLUPcc <- get_model_data(gen_alphaRCC, what = "blupg")
#BLUPs
mixed_mod_Rall_field <-
gamem_met(Rall_field,
ENV,
GEN,
REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
block = BLOCK
)
BLUP_all <- mixed_mod_Rall_field$Rust$BLUPgen
write.xlsx(BLUP_all, "BLUP_all.xlsx", sep = "/t")
BLUP18_19 <- left_join(BLUP18,BLUP19, by = "GEN", suffix = c(".18", ".19"))
BLUP18_19_20 <- left_join(BLUP18_19,BLUP20, by = "GEN")
BLUP18_19_20_all <- left_join(BLUP18_19_20,BLUP_all, by = "GEN")
BLUPALL <- left_join(BLUP18_19_20_all,BLUPcc, by = "GEN")
BLUPALL_info <- left_join(BLUPALL,Panel_info, by = "GEN")
View(BLUPALL_info)
write.xlsx(BLUPALL_info, "BLUP_ALL_info.xlsx", sep = "/t")
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
BLUPs_anova %>%
group_by(ENV, Species) %>%
get_summary_stats(BLUP, type = "mean_sd")
BLUPs_anova %>%
group_by(ENV, Material) %>%
get_summary_stats(BLUP, type = "mean_sd")
knitr::opts_chunk$set(echo = TRUE)
# revisa si es necesario instalar los paquetes
list.of.packages <- c("tidyverse",
"ggpubr",
"ggstatsplot",
"openintro",
"rstatix",
"DescTools",
"WRS2",
"metan",
"ggstastplot",
"openxlsx",
"readxl")
new.packages <- list.of.packages[!(list.of.packages %in%
installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(tidyverse) # manipulación y visualización de datos
library(ggpubr) # gráficos sencillos
library(ggstatsplot) # gráficos listos para publicar
library(openintro) # datos de ejemplo
library(rstatix) # pruebas P/NP y estadísticos con tuberías.
library(DescTools) # prueba robusta de Yuen
library(WRS2) # tamaño de efecto robustos
library(metan)
library(ggstatsplot)
library(openxlsx)
library(readxl)
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
BLUPs_anova %>%
group_by(ENV, Material) %>%
get_summary_stats(BLUP, type = "mean_sd")
ggplot(data = BLUPs_anova, aes(x = Material, y = BLUP)) +
geom_boxplot(aes(fill = ENV), width = 0.8) + theme_bw()
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
ggplot(data = BLUPs_anova, aes(x = Material, y = BLUP)) +
geom_boxplot(aes(fill = ENV), width = 0.8) + theme_bw()
ggqqplot(BLUPs_anova, "BLUP", ggtheme = theme_bw()) +
facet_grid(Material ~ ENV)
BLUPs_anova %>% levene_test(BLUP ~ Material*ENV)
BLUPs_anova %>%
group_by(ENV, Material) %>%
identify_outliers(BLUP)
BLUPs_anova %>%
group_by(ENV, Material) %>%
identify_outliers(BLUP)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Material, p.adjust.method = "holm")
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm")
grouped_ggbetweenstats(data = BLUPs_anova, x = ENV, y = BLUP, grouping.var = Material,
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
grouped_ggbetweenstats(data = BLUPs_anova, x = ENV, y = BLUP, grouping.var = Material, type = "np",
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
grouped_ggbetweenstats(data = BLUPs_anova, x = Material, y = BLUP, grouping.var = ENV, type = "np",
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
BLUPs_anova
grouped_ggbetweenstats(data = BLUPs_anova, x = Structure, y = BLUP, grouping.var = ENV, type = "np",
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm")
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter_(p.adj < 0.05)
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter_(p.adj < 0.05)
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm")
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.05)
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Material, p.adjust.method = "holm")%>%
filter(p.adj < 0.01)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Material * ENV)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Material * ENV)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Material * ENV)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Material * ENV)
BLUPs_anova %>%
anova_test(BLUP ~ Species * ENV)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Species, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Species, p.adjust.method = "holm")
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Species)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Species * ENV)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Material, p.adjust.method = "holm")%>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Species, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova <- read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/BLUP_ALL_info.xlsx",
sheet = "R",
col_types =
c("text", #GEN
"text", #ENV
"numeric", #BLUP
"text", #Reference
"text", #Specie
"text", #Name
"text", #Origen
"text", #Material
"text" #Structure
))
BLUPs_anova %>%
group_by(ENV, Material) %>%
get_summary_stats(BLUP, type = "mean_sd")
ggplot(data = BLUPs_anova, aes(x = Material, y = BLUP)) +
geom_boxplot(aes(fill = ENV), width = 0.8) + theme_bw()
ggqqplot(BLUPs_anova, "BLUP", ggtheme = theme_bw()) +
facet_grid(Material ~ ENV)
BLUPs_anova %>% levene_test(BLUP ~ Material*ENV)
BLUPs_anova %>%
anova_test(BLUP ~ ENV * Material)
BLUPs_anova %>%
anova_test(BLUP ~ Species * ENV)
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Material, p.adjust.method = "holm")%>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Material) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
grouped_ggbetweenstats(data = BLUPs_anova, x = Material, y = BLUP, grouping.var = ENV, type = "np",
results.subtitle = F, messages = F, var.equal = T, p.adjust.method = "holm")
BLUPs_anova %>%
group_by(ENV) %>%
pairwise_t_test(BLUP ~ Species, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
BLUPs_anova %>%
group_by(Species) %>%
pairwise_t_test(BLUP ~ ENV, p.adjust.method = "holm") %>%
filter(p.adj < 0.01)
# revisa si es necesario instalar los paquetes
list.of.packages <- c("tidyverse",
"ggpubr",
"ggstatsplot",
"openintro",
"rstatix",
"DescTools",
"WRS2",
"metan",
"ggstastplot",
"openxlsx",
"readxl")
new.packages <- list.of.packages[!(list.of.packages %in%
installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(tidyverse) # manipulación y visualización de datos
library(ggpubr) # gráficos sencillos
library(ggstatsplot) # gráficos listos para publicar
library(openintro) # datos de ejemplo
library(rstatix) # pruebas P/NP y estadísticos con tuberías.
library(DescTools) # prueba robusta de Yuen
library(WRS2) # tamaño de efecto robustos
library(metan)
library(ggstatsplot)
library(openxlsx)
library(readxl)
library(tidyverse) # manipulación y visualización de datos
library(ggpubr) # gráficos sencillos
library(ggstatsplot) # gráficos listos para publicar
library(openintro) # datos de ejemplo
library(rstatix) # pruebas P/NP y estadísticos con tuberías.
library(DescTools) # prueba robusta de Yuen
library(WRS2) # tamaño de efecto robustos
library(metan)
library(ggstatsplot)
library(openxlsx)
library(readxl)
ggplot(data = BLUPs_anova, aes(x = Material, y = BLUP)) +
geom_boxplot(aes(fill = ENV), width = 0.8) + theme_bw()
