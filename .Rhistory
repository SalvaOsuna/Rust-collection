#2020
material20 <- select(R20_nc, c(5,6,7))
material20 <- material20[1:324,1:3]
#2020
material20 <- select(R20_nc, c(5,6,7))
material20 <- material20[1:324,1:3]
BLUP20 <- as.data.frame(get_model_data(gen_alphaR20, "blupg"))
BLUP20 <-cbind(BLUP20, material20)
corr_plot(BLUP19, GDD_F, GDD_P,GDD_M, Biom_plant_g, yield_plant_g, Rust,Asco, Oidio, col.by = Material)
corr_plot(BLUP20, GDD_F, GDD_P,GDD_M, Biom_plant_g, yield_plant_g, Rust,Asco, Oidio, col.by = Material)
corr_plot(BLUP20, GDD_DTF, GDD_DTP,GDD_M, Biom_plant_g, yield_plant_g, Rust,Asco, Oidio, col.by = Material)
#Boxplots
#2018
ggbetweenstats(x = Material, y = Rust, data = BLUP18,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
#2019
ggbetweenstats(x = Material, y = Rust, data = BLUP19,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
#2020
ggbetweenstats(x = Material, y = Rust, data = BLUP20,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
ggbetweenstats(x = Structure, y = Rust, data = BLUP18,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
ggbetweenstats(x = Structure, y = Rust, data = BLUP19,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
ggbetweenstats(x = Structure, y = Rust, data = BLUP20,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
#season 2018
R18_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R18_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"numeric", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #DtP
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #Asco
"numeric", #Rust
"numeric" #Oidio
))
R18_nc$ENV <- as.factor(R18_nc$ENV)
R18_nc$REP <- as.factor(R18_nc$REP)
R18_nc$BLOCK <- as.factor(R18_nc$BLOCK)
R18_nc$ROW <- as.factor(R18_nc$ROW)
R18_nc$Material <- as.factor(R18_nc$Material)
R18_nc$Species <- as.factor(R18_nc$Species)
R18_nc$Structure <- as.factor(R18_nc$Structure)
R18_nc$GEN <- as.factor(R18_nc$GEN)
#season 2019
R19_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R19_nc$ENV <- as.factor(R19_nc$ENV)
R19_nc$REP <- as.factor(R19_nc$REP)
R19_nc$BLOCK <- as.factor(R19_nc$BLOCK)
R19_nc$ROW <- as.factor(R19_nc$ROW)
R19_nc$Material <- as.factor(R19_nc$Material)
R19_nc$Species <- as.factor(R19_nc$Species)
R19_nc$Structure <- as.factor(R19_nc$Structure)
R19_nc$GEN <- as.factor(R19_nc$GEN)
#season 2020
R20_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R20_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Asco
"numeric", #Oidio
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R20_nc$ENV <- as.factor(R20_nc$ENV)
R20_nc$REP <- as.factor(R20_nc$REP)
R20_nc$BLOCK <- as.factor(R20_nc$BLOCK)
R20_nc$ROW <- as.factor(R20_nc$ROW)
R20_nc$Material <- as.factor(R20_nc$Material)
R20_nc$Species <- as.factor(R20_nc$Species)
R20_nc$Structure <- as.factor(R20_nc$Structure)
R20_nc$GEN <- as.factor(R20_nc$GEN)
#functions#
library("metan")
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
gen_alphaR19 <-
gamem(R19_nc,
GEN,
REP,
resp = c("GERM", "GDD_FF", "GDD_F", "GDD_FP", "GDD_P","GDD_M", "Rust", "Biom_plant_g", "yield_plant_g"),
BLOCK)
gen_alphaR20 <-
gamem(R20_nc,
GEN,
REP,
resp = c("GERM", "GDD_DTFF", "GDD_DTF", "GDD_DTFP", "GDD_DTP", "GDD_M", "Rust", "Asco", "Oidio", "Biom_plant_g", "yield_plant_g"),
BLOCK)
View(BLUP18)
get_model_data(gen_alphaR18)
get_model_data(gen_alphaR19)
get_model_data(gen_alphaR20)
#Correlations
#2018
material18 <- select(R18_nc, c(5,6,7))
material18 <- material18[1:323,1:3]
BLUP18 <- as.data.frame(get_model_data(gen_alphaR18, "blupg"))
BLUP18 <-cbind(BLUP18, material18)
corr_plot(BLUP18, GDD_F, GDD_P, Biom_plant_g, yield_plant_g, Asco, Rust, Oidio, col.by = Material)
corr_plot(BLUP19, GDD_F, GDD_P,GDD_M, Biom_plant_g, yield_plant_g, Rust, col.by = Material)
corr_plot(BLUP20, GDD_DTF, GDD_DTP,GDD_M, Biom_plant_g, yield_plant_g, Rust,Asco, Oidio, col.by = Material)
#Boxplots
#2018
ggbetweenstats(x = Material, y = Rust, data = BLUP18,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
ggbetweenstats(x = Structure, y = Rust, data = BLUP18,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
ggbetweenstats(x = Structure, y = Rust, data = BLUP19,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
#2019
ggbetweenstats(x = Material, y = Rust, data = BLUP19,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
#2020
ggbetweenstats(x = Material, y = Rust, data = BLUP20,
p.adjust.method = "none", type = "np",
bf.message = FALSE, var.equal = F,
ggsignif.args = list(textsize = 1.5, tip_length = 0.01)) +
theme(text = element_text(size = 8), plot.subtitle = element_text(size=8))
#season 2018
R18_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R18_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"numeric", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #DtP
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #Asco
"numeric", #Rust
"numeric" #Oidio
))
##LOAD DATA##
library(readxl)
R18_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R18_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"numeric", #GEN
"numeric", #GERM
"numeric", #DtF
"numeric", #DtP
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #biomass_pl
"numeric", #yield_pl
"numeric", #Asco
"numeric", #Rust
"numeric" #Oidio
))
R18_nc$ENV <- as.factor(R18_nc$ENV)
R18_nc$REP <- as.factor(R18_nc$REP)
R18_nc$BLOCK <- as.factor(R18_nc$BLOCK)
R18_nc$ROW <- as.factor(R18_nc$ROW)
R18_nc$Material <- as.factor(R18_nc$Material)
R18_nc$Species <- as.factor(R18_nc$Species)
R18_nc$Structure <- as.factor(R18_nc$Structure)
R18_nc$GEN <- as.factor(R18_nc$GEN)
#season 2019
R19_nc <- read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R19_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R19_nc$ENV <- as.factor(R19_nc$ENV)
R19_nc$REP <- as.factor(R19_nc$REP)
R19_nc$BLOCK <- as.factor(R19_nc$BLOCK)
R19_nc$ROW <- as.factor(R19_nc$ROW)
R19_nc$Material <- as.factor(R19_nc$Material)
R19_nc$Species <- as.factor(R19_nc$Species)
R19_nc$Structure <- as.factor(R19_nc$Structure)
R19_nc$GEN <- as.factor(R19_nc$GEN)
#season 2020
R20_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R20_nc",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_FF
"numeric", #GDD_F
"numeric", #GDD_FP
"numeric", #GDD_P
"numeric", #GDD_M
"numeric", #Rust
"numeric", #Asco
"numeric", #Oidio
"numeric", #Biom_pl_g
"numeric" #yield_pl_g
))
R20_nc$ENV <- as.factor(R20_nc$ENV)
R20_nc$REP <- as.factor(R20_nc$REP)
R20_nc$BLOCK <- as.factor(R20_nc$BLOCK)
R20_nc$ROW <- as.factor(R20_nc$ROW)
R20_nc$Material <- as.factor(R20_nc$Material)
R20_nc$Species <- as.factor(R20_nc$Species)
R20_nc$Structure <- as.factor(R20_nc$Structure)
R20_nc$GEN <- as.factor(R20_nc$GEN)
#Three field Seasons
Rall_field <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Genomic-Selection/Genomic Selection_SALVA/data/R18_19_20.xlsx",
sheet = "R_all",
col_types =
c("text", #ENV
"text", #REP
"text", #BLOCK
"numeric", #ROW
"text", #Specie
"text", #Material
"text", #Structure
"text", #GEN
"numeric", #GERM
"numeric", #GDD_F
"numeric", #GDD_P
"numeric", #Biom_pl_g
"numeric", #yield_pl_g
"numeric", #Rust
"numeric", #Asco
"numeric" #Oidio
))
Rall_field$ENV <- as.factor(Rall_field$ENV)
Rall_field$REP <- as.factor(Rall_field$REP)
Rall_field$BLOCK <- as.factor(Rall_field$BLOCK)
Rall_field$ROW <- as.factor(Rall_field$ROW)
Rall_field$Material <- as.factor(Rall_field$Material)
Rall_field$Species <- as.factor(Rall_field$Species)
Rall_field$Structure <- as.factor(Rall_field$Structure)
Rall_field$GEN <- as.factor(Rall_field$GEN)
#functions#
library("metan")
gen_alphaR18 <-
gamem(R18_nc,
GEN,
REP,
resp = c("GERM", "DtF", "DtP", "GDD_F", "GDD_P", "Biom_plant_g", "yield_plant_g", "Asco", "Rust", "Oidio"),
BLOCK)
gen_alphaR19 <-
gamem(R19_nc,
GEN,
REP,
resp = c("GERM", "GDD_FF", "GDD_F", "GDD_FP", "GDD_P","GDD_M", "Rust", "Biom_plant_g", "yield_plant_g"),
BLOCK)
gen_alphaR20 <-
gamem(R20_nc,
GEN,
REP,
resp = c("GERM", "GDD_DTFF", "GDD_DTF", "GDD_DTFP", "GDD_DTP", "GDD_M", "Rust", "Asco", "Oidio", "Biom_plant_g", "yield_plant_g"),
BLOCK)
mixed_mod_Rall_field <-
gamem_met(Rall_field,
ENV,
GEN,
REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
block = BLOCK
)
#The WAASB object
waasb_model <-
waasb(Rall_field,
env = ENV,
gen = GEN,
rep = REP,
resp = c("GERM", "GDD_F", "GDD_P", "Rust", "Biom_plant_g", "yield_plant_g"),
random = "gen", #Default
verbose = TRUE) #Default
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-controlled/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila
"numeric", #L_border
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc <- #NoControls
read_excel("C:/Users/Salva/Documents/GitHub/Rust-collection/data/Rust_controlled_condition.xlsx",
sheet = "CC_n",
col_types =
c("text", #REP
"text", #BLOCK
"text", #GEN
"numeric", #L_area
"numeric", #L_aphila
"numeric", #L_border
"numeric", #AUDPC_n
"numeric", #GPL50_n
"numeric", #IF_n
"numeric", #DS_n
"numeric" #IT_n
))
RCC_nc$REP <- as.factor(RCC_nc$REP)
RCC_nc$BLOCK <- as.factor(RCC_nc$BLOCK)
RCC_nc$GEN <- as.factor(RCC_nc$GEN)
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("L_area", "L_aphila", "L_border", "AUDPC_n", "PL_50", "IF_n", "IT_n"),
BLOCK)
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("L_area", "L_aphila", "L_border", "AUDPC_n", "PL50_n", "IF_n", "IT_n"),
BLOCK)
get_model_data(gen_alphaRCC)
gen_alphaRCC <-
gamem(RCC_nc,
GEN,
REP,
resp = c("AUDPC_n", "PL50_n", "IF_n", "IT_n"),
BLOCK)
get_model_data(gen_alphaRCC)
get_model_data(gen_alphaRCC, "re")
get_model_data(gen_alphaRCC, "gamem")
get_model_data(gen_alphaRCC, "genpar")
get_model_data(gen_alphaRCC, "ranef")
get_model_data(gen_alphaRCC, "details")
plot(gen_alphaRCC)
get_model_data(gen_alphaRCC, what = 2)
get_model_data(gen_alphaRCC, what = "2")
fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 15,
mineval = 1,
verbose = TRUE
)
fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 10,
mineval = 1,
verbose = TRUE
)
fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 12,
mineval = 1,
verbose = TRUE
)
fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 13,
mineval = 1,
verbose = TRUE
)
fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 14,
mineval = 1,
verbose = TRUE
)
fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 15,
mineval = 1,
verbose = TRUE
)
FAI <- fai_blup(
gen_alphaRCC,
use_data = "blup",
DI = c("min, max, min, min"),
UI = c("max, min, max, max"),
SI = 15,
mineval = 1,
verbose = TRUE
)
plot(FAI)
